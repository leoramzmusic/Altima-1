<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">

<head>
<div th:replace="navegacion-head :: header"></div>
<title>Prendas | Altima</title>
<link href="/dist/css/select2.min.css" rel="stylesheet" />
<link href="/dist/css/select2-bootstrap4.css" rel="stylesheet">
</head>

<body class="hold-transition sidebar-mini layout-fixed sidebar-collapse">
	<!-- Site wrapper -->
	<div class="wrapper">
		<!-- Navbar -->
		<div th:insert="navegacion-nav"></div>
		<!-- /.navbar -->
		<!-- Modal -->
		<div th:insert="navegacion-logout"></div>
		<!-- Main Sidebar Container -->
		<div th:insert="navegacion-aside"></div>

		<!-- Content Wrapper. Contains page content -->
		<div class="content-wrapper">
			<!-- Content Header (Page header) -->
			<section class="content-header">
				<div class="container-fluid">
					<div class="row mb-2">
						<div class="col-sm-6">
						    <h1>Prendas&nbsp;<a th:href="${'/prendas'}"><button class="bt btn-danger btn-circle btn-sm popoverxd" data-container="body" data-toggle="popover" data-placement="right" data-content="Regresar"><i class="fas fa-arrow-left"></i></button></a></h1>
                        </div>
						<div class="col-sm-6">
							<ol class="breadcrumb float-sm-right">
								<li class="breadcrumb-item"><a href="#">Dashboard</a></li>
								<li class="breadcrumb-item active">Prendas</li>
							</ol>
						</div>
					</div>
				</div>
				<!-- /.container-fluid -->
			</section>

			<!-- Main content -->
			<section class="content">
				<div class="container-fluid">
					<div class="row">
						<div class="col-12">
							<!-- Default box -->
							<div class="card">
								<div class="card-header bg-dark">
									<h3 class="card-title">Agregar prenda</h3>
								</div>
								<div class="card-body">
									<div class="row">
										<section class="col-12">
											<ul class="nav nav-tabs flex-nowrap" role="tablist">
												<li role="presentation" class="nav-item"><a
													href="#step1" class="nav-link active" data-toggle="tab"
													aria-controls="step1" role="tab"><i
														class="fas fa-info-circle"></i>&nbsp;Datos generales</a></li>
												<li role="presentation" class="nav-item"><a
													href="#step2" class="nav-link disabled" data-toggle="tab"
													aria-controls="step2" role="tab"><i
														class="fas fa-file-alt"></i>&nbsp;Datos de
														confecci&oacute;n</a></li>
												<li role="presentation" class="nav-item"><a
													href="#step3" class="nav-link disabled" data-toggle="tab"
													aria-controls="step3" role="tab"><i
														class="flaticon-001-wool"></i>&nbsp;Materiales a usar</a></li>
												<li role="presentation" class="nav-item"><a
													href="#complete" class="nav-link disabled"
													data-toggle="tab" aria-controls="complete" role="tab"><i
														class="flaticon-019-pattern-1"></i>&nbsp;Piezas de
														patronaje</a></li>
												<li role="presentation" class="nav-item"><a
													href="#consumo" class="nav-link disabled"
													data-toggle="tab" aria-controls="complete" role="tab"><i class="fas fa-tshirt"></i>
													&nbsp;Consumo por talla</a></li>
											</ul>
											<!-- <form th:action="@{/prendas}" method="post"
												th:object="${disenio}">-->
												<div th:object="${prenda}">
												<input type="hidden" value="guardar" id="accionPag"/>
												<div class="tab-content py-2">
													<div class="tab-pane active" role="tabpanel" id="step1">
														<div class="row">
															<div class="col-sm-4">
																<div class="form-group">
																	<label>Tipo de prenda</label> 
																	<select placeholder="Elige un tipo de prenda" id="TipoPrenda" class="form-control">
																		<option value=""></option>
																		<option th:each="familia: ${familias}" th:value="${familia[0]}" 
																		th:text="${familia[1]}" th:selected="${familia[0] == prenda.idFamiliaPrenda}"></option>
																	</select>
																</div>
															</div>
															<div class="col-sm-4">
																<div class="form-group">
																	<label style="font-size: 15px;">Descripci&oacute;n
																		de la prenda</label> <input type="text" class="form-control"
																		placeholder="Descripcion de Prenda" th:field="*{descripcionPrenda}" id="DescripcionPrenda">
																</div>
															</div>
															<div class="col-sm-4">
																<div class="form-group">
																	<label style="font-size: 15px;">Nota especial</label> <input
																		type="text" class="form-control" placeholder="Nota de Prenda"  th:field="*{notaEspecial}" id="NotaEspecial">
																</div>
															</div>
															
															<div class="col-sm-10">
																<div class="form-group">
																	<label>Detalle de la prenda</label>
																	<textarea class="form-control" rows="3"
																		placeholder="Escribir el detalle de la prenda..." id="DetallePrenda" 
																		th:field="*{detallePrenda}"></textarea>
																</div>
															</div>
															<div class="col-sm-2" style="font-size: 15px;">
																<div class="form-group">
																<label>&nbsp;</label>
																	<div class="custom-control custom-switch custom-switch-off-danger custom-switch-on-success">
																		<input type="checkbox" class="custom-control-input"
																			id="ticket" th:checked="${prenda.imprimirEtiquetas == '1'}"> <label
																			class="custom-control-label" for="ticket">Imprimir
																			ticket</label>
																	</div>
																</div>
																<div class="custom-control custom-switch custom-switch-off-danger custom-switch-on-success">
																		<input type="checkbox" class="custom-control-input" id="combi"> <label
																			class="custom-control-label" for="combi">Lleva
																			combinaci&oacute;n</label>
																	</div>
																	<!--  th:checked="${prenda.combinacion == '1'}" -->
															</div>
														</div>
														
														<!-- Form de Imagen Doble -->
														<form th:action="@{/prendas}" method="POST" enctype="multipart/form-data" th:object="${disenio}" ><!-- Abre form de la imagen -->
														<input type="hidden" name="_csrf" id="token"  th:value="${_csrf.token}"/><div class="row">
															<div class="col-sm-12">
																<div class="form-group p-3 border p-2 rounded m-3">
																	<div class="row">
																		<div class="col-sm-3 text-center pt-2 border-right">
																			<label for="mainImage1">
																				<img th:src="@{'/uploads/prendas/' + ${prenda.dibujoEspalda}}" alt="Placeholder" id="blah1" class="placeholder img-thumbnail"
																				aria-describedby="imagePreviewHelp1" th:onerror="this.src='/dist/img/preview.png'"/></label> 
																				<small id="imagePreviewHelp1" class="form-text text-muted">Previsualizaci&oacute;n
																				de la imagen</small>
																		</div>
																		<div class="col">
																			<label for="mainImage1">Imagen frontal</label>
																			<div class="input-group mb-3">
																				<input type="file" class="form-control border p-1" id="file" name="file"/>
																				<div class="input-group-append">
																					<span class="input-group-text bg-danger text-danger pointer" onclick="LimpiarInput1()">
																						<i class="fas fa-times"></i>
																					</span>
																				</div>
																			</div>
																			<small id="imageHelp1" class="form-text text-muted">Selecciona la foto que desea subir.</small>
																		</div>
																	</div>
																</div>
															</div>
															<div class="col-sm-12">
																<div class="form-group p-3 border p-2 rounded m-3">
																	<div class="row">
																		<div class="col-sm-3 text-center pt-2 border-right">
																			<label for="mainImage"><img th:src="@{'/uploads/prendas/' + ${prenda.dibujoFrente}}" alt="Placeholder" id="blah2" class="placeholder img-thumbnail"
																				aria-describedby="imagePreviewHelp" th:onerror="this.src='/dist/img/preview.png'"/></label> 
																				<small id="imagePreviewHelp" class="form-text text-muted">Previsualizaci&oacute;n
																				de la imagen</small>
																		</div>
																		<div class="col">
																			<label for="mainImage">Imagen espalda/trasero</label>
																			<div class="input-group mb-3">
																				<input type="file" class="form-control border p-1" id="file2" name="file2"/>
																				<div class="input-group-append">
																					<span class="input-group-text bg-danger text-danger pointer" onclick="LimpiarInput2()">
																						<i class="fas fa-times"></i>
																					</span>
																				</div>
																			</div>
																			<small id="imageHelp" class="form-text text-muted">Selecciona la foto que desea subir.</small>
																		</div>
																	</div>
																</div>
															</div>
															<div class="form-group col-sm-12">
																<a th:href="${'/prendas'}" class="btn btn-danger">Cancelar</a>
																<button type="button" class="btn btn-primary float-right" onclick="ValidarPrimerPestana()">Siguiente</button>	
																<button type="button" class="btn btn-primary next-step float-right" id="SiguientePrimeraPestana" style="display: none">Siguiente</button><br>
																<button type="submit" id="FormImagenes" style="border: none"></button>
															</div>
															<div class="form-group col-sm-12" id="AlertaPrimerPestana" style="display: none; color: red;">
																<div class="float-right">
																	<label>Debes llenar todos los campos correctamente.</label>
																</div>
															</div>
														</div>
														</form>
														<!-- Form de imagen doble -->
													</div>
													
														<!-- Form de imagen Frente -->
														<form th:action="@{/prendas1}" method="POST" enctype="multipart/form-data" th:object="${disenio}" style="display: none">
															<div id="ContenedorFrente"></div>
															<button type="submit" id="FormImagenFrente" style="border: none"></button>
														</form>
														<!-- Form de imagen Frente -->
														
														<!-- Form de imagen Espalda -->
														<form th:action="@{/prendas2}" method="POST" enctype="multipart/form-data" th:object="${disenio}" style="display: none">
															<div id="ContenedorEspalda"></div>
															<button type="submit" id="FormImagenEspalda" style="border: none"></button>
														</form>
														<!-- Form de imagen Espalda -->
													
													
													
													<div class="tab-pane" role="tabpanel" id="step2">
														<div class="row">
															<div class="col-sm-12">
																<div class="form-group">
																	<label>Detalle de la confecci&oacute;n</label>
																	<textarea class="form-control" rows="6" th:field="*{detalleConfeccion}"
																		placeholder="Especificar" id="DetalleConfeccion"></textarea>
																</div>
															</div>
															<label for="adicionar" style="margin-left: 7px;">Marcadores&nbsp;&nbsp;</label>
                                                            <div class="input-group col-sm-12">
											
                                                                <select class="form-control" name="marcador_" id="marcador_">
                                                                    
                                                                    <option th:each="marcador:${marcadores}"th:value="${marcador.idLookup}" th:text="${marcador.nombreLookup}"></option>
                                                                </select>
															  <span class="input-group-btn">
															    <button id="adicionar" class="btn btn-primary" type="button" onclick="guardarMarcador()">
                                                                    <i class="fas fa-plus"></i>
                                                                </button>
															  </span>
															</div>
															<br><br>
                                                            <div class="col-sm-12">

                                                                <table class="table table-bordered table-hover">
                                                                    <thead>
                                                                        <tr>
                                                                            <th style="display: none;">Id</th>
                                                                            <th>Lista</th>
                                                                            <th>Eliminar</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="tablita">
                                                                        <tr th:each="pm:${prendasmarcadores}">
                                                                            <td style="display: none;" th:text="${pm[0]}"></td>
                                                                            <td th:text="${pm[1]}"></td>
                                                                            <td>
                                                                                <button type="button" name="remove" onclick="eliminarMarcador(this)" class="btn btn-danger btn_remove">Quitar</button>
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>

                                                            </div>
														</div>
														<div class="row float-right" >
														<ul class="float-right">	
															<li class="list-inline-item">
															<a th:href="${'/prendas'}" class="btn btn-danger mr-auto">Cancelar</a>
																<button type="button" class="btn btn-primary" onclick="ValidarSegundaPestana()">Siguiente</button>
																<button type="button" class="btn btn-primary next-step" style="display: none" id="SiguienteSegundaPestana">Siguiente</button>
															</li>
														</ul>
														</div><br><br><br>
														<div class="row float-right" id="AlertaSegundaPestana" style="display: none; color: red;">
														<ul class="float-right">
															<li class="list-inline-item">
																<div class="float-right">
																	<label>Debes llenar todos los campos correctamente.</label>
																</div>
															</li>
														</ul>
														</div>
													</div>
													<div class="tab-pane" role="tabpanel" id="step3">
														<div class="row">
															<div class="col-sm-10">
																<div class="form-group">
																	<label>Lista de materiales</label>
																	<select placeholder="Elige una prenda" id="ListaDeMateriales" class="form-control">
																			<option th:each="materiales : ${materiales}" th:value="${materiales[0]}" th:text="${materiales[1]}"></option>
																			
																	</select>
																</div>
															</div>
															<div class="col-sm-2">
																<label>&nbsp;</label>
																<div class="form-group">
																<!-- aÃ±adir a clas btn-block -->
																	<button class="btn btn-primary" onclick="AgregarElementoListaMateriales()" id="AgregarElementoMaterial">
																		<i class="fas fa-plus fa-sm"></i> Agregar
																	</button>
																</div>
															</div>
															<div class="col-md-12">
																<table class="table table-striped table-bordered">
																	<thead>
																		<tr>
																			<th scope="col">Clave AMP</th>
																			<th scope="col">Nombre</th>
																			<th scope="col">Clasificaci&oacute;n</th>
																			<th scope="col">Tama&ntilde;o</th>
																			<th scope="col">Modelo</th>
																			<th scope="col">Proceso</th>
																			<th scope="col">Cantidad</th>
																			<th scope="col"></th>
																		</tr>
																	</thead>
																	<tbody id="CuerpoTablaMateriales">
																	</tbody>
																</table>
															</div>
														</div>
														<!-- <ul class="float-right">
															<li class="list-inline-item">
															
																<button type="button" class="btn btn-outline-primary next-step">Siguiente</button>
															</li>
														</ul> -->
													<div class="row float-right" >
														<ul class="float-right">	
															<li class="list-inline-item">
																<a th:href="${'/prendas'}" class="btn btn-danger mr-auto">Cancelar</a>
																<button type="button" class="btn btn-primary" onclick="ValidarTerceraPestana()">Siguiente</button>
																<button type="button" class="btn btn-primary next-step" style="display: none" id="SiguienteTerceraPestana">Siguiente</button>
															</li>
														</ul>
														</div><br><br><br>
														<div class="row float-right" id="AlertaTerceraPestana" style="display: none; color: red;">
														<ul class="float-right">
															<li class="list-inline-item">
																<div class="float-right">
																	<label>Debes agregar al menos un material.</label>
																</div>
															</li>
														</ul>
													</div>
													</div>
													<div class="tab-pane" role="tabpanel" id="complete">
                                                        <div class="row">
                                                            <div class="col-sm-10">
                                                                <div class="form-group">
                                                                    <label>Lista de piezas de patronaje</label>
                                                                    <select placeholder="Elige una prenda" id="ListaPatronaje" class="form-control">
                                                                        <option th:each="patronajes : ${patronajes}" th:value="${patronajes[0]}" th:text="${patronajes[2]}"></option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                            <div class="col-sm-2">
                                                                <label>&nbsp;</label>
                                                                <div class="form-group">
                                                                    <div id="BotonAgregar" style="display: block">
                                                                        <button class="btn btn-primary btn-block" onclick="guardarPatronaje()" id="BotonAgregarPatronaje">
                                                                            <i class="fas fa-plus fa-sm"></i> Agregar
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-12">
                                                                <table class="table table-striped table-bordered">
                                                                    <thead>
                                                                        <tr>
                                                                            <th scope="col" style='display: none;'>Id</th>
                                                                            <th scope="col">Nombre</th>
                                                                            <th scope="col" class="text-center">Tela<br>N&uacute;mero de piezas</th>
                                                                            <th scope="col" class="text-center">Forro<br>N&uacute;mero de piezas</th>
                                                                            <th scope="col" class="text-center">Entretela<br>N&uacute;mero de piezas</th>
                                                                            <th scope="col">Quitar</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="CuerpoPatronaje">

                                                                        <tr th:each="pat: ${patronajesPrenda}" >
                                                                            <td style='display: none;' th:text="${pat[6]}"></td>
                                                                            <td th:text="${pat[2]}"></td>
                                                                            <td><input type="number" class="form-control" th:value="${pat[3]}" placeholder="10" th:id="${'CantidadTela'+pat[6]}"></td>
                                                                            <td><input type="number" class="form-control" th:value="${pat[4]}" placeholder="10" th:id="${'CantidadForro'+pat[6]}"></td>
                                                                            <td><input type="number" class="form-control" th:value="${pat[5]}" placeholder="10" th:id="${'CantidadEntretela'+pat[6]}"></td>
                                                                            <td class="tdcenter">
                                                                                <button class="btn btn-danger btn_remove" onclick="eliminarPatronaje(this)">Quitar
                                                                                </button>
                                                                            </td>
                                                                        </tr>

                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>

                                                        <div class="row float-right">
                                                            <ul class="float-right">
                                                                <li class="list-inline-item">
                                                                    <button type="button" class="btn btn-primary" onclick="ValidarCuartaPestana()">Guardar</button>
                                                                    <button type="button" class="btn btn-primary" style="display: none" id="SiguienteCuartaPestana" onclick="Guardar()">Guardar</button>
                                                                </li>
                                                            </ul>
                                                        </div>
														<br><br><br>
														<div class="row float-right" id="AlertaCuartaPestana" style="display: none; color: red;">
														<ul class="float-right">
															<li class="list-inline-item">
																<div class="float-right">
																	<label>Debes agregar al menos un elemento.</label>
																</div>
															</li>
														</ul>
													</div>
													<div class="row float-right" id=AlertaCantidadesPatronaje style="display: none; color: red !important">
														<ul class="float-right">
															<li class="list-inline-item">
																<div class="float-right">
																	<label>Debes agregar las cantidades.</label>
																</div>
															</li>
														</ul>
													</div>
													</div>
													<div class="tab-pane" role="tabpanel" id="consumo">
                                                        <div class="row">
                                                            <div class="col-sm-12">
                                                                <div class="form-group">
                                                                    <label>Lista de tallas</label>
                                                                    <select placeholder="Elige una prenda" id="ListaPatronaje">
                                                                        <option>XL</option>
                                                                        <option>L</option>
                                                                        <option>M</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                            <div class="col-sm-3">
                                                                <label>&nbsp;</label>
                                                                <div class="form-group">
                                                                    <div id="BotonAgregar">
                                                                        <button class="btn btn-primary btn-block">
                                                                            <i class="fas fa-plus fa-sm"></i> Agregar
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-12">
                                                                <table class="table table-striped table-bordered">
                                                                    <thead>
                                                                        <tr>
                                                                            <th scope="col">Nombre</th>
                                                                            <th scope="col">Cantidad de tela</th>
                                                                            <th scope="col">Cantidad de forro</th>
                                                                            <th scope="col">Cantidad de entretela</th>
                                                                            <th scope="col">Largo</th>
                                                                            <th scope="col">Quitar</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <tr>
                                                                            <td>XL</td>
                                                                            <td><input type="number" class="form-control" placeholder="10"></td>
                                                                            <td><input type="number" class="form-control" placeholder="10"></td>
                                                                            <td><input type="number" class="form-control" placeholder="10"></td>
                                                                            <td><input type="number" class="form-control" placeholder="10"></td>
                                                                            <td class="tdcenter">
                                                                                <button class="btn btn-danger">Quitar
                                                                                </button>
                                                                            </td>
                                                                        </tr>

                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>

                                                        <div class="row float-right">
                                                            <ul class="float-right">
                                                                <li class="list-inline-item">
                                                                    <button type="button" class="btn btn-primary">Guardar</button>
                                                                    <button type="button" class="btn btn-primary next-step">Guardar</button>
                                                                </li>
                                                            </ul>
                                                        </div>
														<br><br><br>
														<div class="row float-right" id="AlertaCuartaPestana" style="display: none; color: red;">
														<ul class="float-right">
															<li class="list-inline-item">
																<div class="float-right">
																	<label>Debes agregar al menos un elemento.</label>
																</div>
															</li>
														</ul>
													</div>
													<div class="row float-right" id=AlertaCantidadesPatronaje style="display: none; color: red !important">
														<ul class="float-right">
															<li class="list-inline-item">
																<div class="float-right">
																	<label>Debes agregar las cantidades.</label>
																</div>
															</li>
														</ul>
													</div>
													</div>
													<div class="clearfix"></div>
												</div>
											<!-- /form-->
										</section>
									</div>
								</div>
								<!-- /.card-body -->
							</div>
							<!-- /.card -->
						</div>
					</div>
				</div>
			</section>
			<!-- /.content -->
		</div>
		<!-- /.content-wrapper -->

		<div th:insert="navegacion-footer"></div>
	</div>
	<!-- ./wrapper -->


	<div th:replace="navegacion-scripts"></div>
	<script src="/dist/js/UploadImage.js"></script>
	<script src="/dist/js/select2.min.js"></script>
	<script th:src="@{/dist/js/sweetalert.js}"></script>
	<script src="/dist/js/AgregarPrenda.js"></script>
	<script src="/dist/js/AgregarPrendaAsignar.js"></script>
	<script src="/dist/js/AgregarPrendaObjetos.js"></script>
	<script th:inline="javascript">
		/*<![CDATA[*/
		var message = /*[[${prenda}]]*/ 'default';
		var familias = /*[[${familias}]]*/ 'default';
		var accion = /*[[${accion}]]*/ 'default';
		/*]]>*/
		
		if(accion == "editar")
		{
			var prenda = /*[[${prenda}]]*/ 'default';
			var prendasmarcadores = /*[[${prendasmarcadores}]]*/ 'default';
			var materiales = /*[[${materialesPrenda}]]*/ 'default';
			var patronajesPrenda = /*[[${patronajesPrenda}]]*/ 'default';
			
			objeto_prenda = prenda;
			
			for (i = 0; i < materiales.length; i++) {
                var temp = {
                    identidad: materiales[i][10],
                    id: materiales[i][0],
                    NoMaterial: materiales[i][1],
                    Nombre: materiales[i][2],
                    Clasificacion: materiales[i][3],
                    Tamanio: materiales[i][4] + ' ' + materiales[i][5],
                    Modelo: materiales[i][7],
                    Proceso: materiales[i][8],
                    cantidad: materiales[i][9]
                };
                objeto_materiales.push(temp);
            }
			

			var temporalParaMarcadores = null;
			for(j = 0; j < prendasmarcadores.length; j++)
			{
				temporalParaMarcadores = "," + prendasmarcadores[j][0];
			}
			
			
			prendasmarcadores = temporalParaMarcadores.substring(1);

		}
		
	</script>
	<script src="/dist/js/FormSteps.js"></script>
	<script>
		function changeClassById() {
			document.getElementById("iDiseno").className = "nav-icon flaticon-005-dress";
			document.getElementById("menuDiseno").className = "nav-item has-treeview menu-open";
			document.getElementById("navDiseno").className = "nav-link active";
			document.getElementById("navDiseno3").className = "nav-link active";
		}
		window.onload = changeClassById();
	</script>
</body>

</html>
